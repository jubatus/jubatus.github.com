

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Graph &mdash; Jubatus</title>
    <link rel="stylesheet" href="../_static/jubatus.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

    
<script type="text/javascript">
   var GuideSentence = 'keyword';
   function ShowFormGuide(obj) {
      if( obj.value == '' ) {
         obj.value = GuideSentence;
         obj.style.color = '#cccccc';
      }else{
         obj.style.color = '#333333';
      }
   }
   function HideFormGuide(obj) {
      obj.style.color = '#827046';
      if( obj.value == GuideSentence ) {
         obj.value='';   
      }
   }
</script>
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Jubatus" href="../index.html" />
    <link rel="up" title="Client API" href="api.html" />
    <link rel="next" title="Methods" href="method.html" />
    <link rel="prev" title="Stat" href="api_stat.html" /> 

<!--

   _________         ___
   \____   _|       | /             ___I_I___
       |  |         | |             \__^ ^__/        ____
       |  |         | | ___    ___  __ | |          / __/
       |  | |-|  |-|| |/   \  /   \| | | | |^|  |^|| (__
       |  | | |  | ||    ^  ||  ^    | | | | |  | | \__ \
       |  | | \_/  ||    O   || O    | | |_| \_/  | ___) |
       |  |  \__/|_||_|\___/  \___/|_| |__/ \__/|_| \___/
       | /
      / /
     |/

-->
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-26408953-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

  </script>
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="method.html" title="Methods"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="api_stat.html" title="Stat"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Jubatus</a> &raquo;</li>
          <li><a href="references.html" >References</a> &raquo;</li>
          <li><a href="api.html" accesskey="U">Client API</a> &raquo;</li> 
      </ul>
    </div>
          
		<a href="../index.html">
			 <div class="title"></div>
		</a>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Graph</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#data-structures">Data Structures</a></li>
<li><a class="reference internal" href="#usage-of-properties-and-queries">Usage of Properties and Queries</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="api_stat.html"
                        title="previous chapter">Stat</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="method.html"
                        title="next chapter">Methods</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/en/api_graph.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick Search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" class="keyword" value="keyword" onFocus="HideFormGuide(this);" onBlur="ShowFormGuide(this);" />
                <input type="submit" value="Go" class="searchBtn" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
	  
          

<script src="http://widgets.twimg.com/j/2/widget.js"></script>
<script>
new TWTR.Widget({
  version: 2,
  type: 'profile',
  rpp: 4,
  interval: 30000,
  width: 220,
  height: 300,
  theme: {
    shell: {
      background: '#333333',
      color: '#ffffff'
    },
    tweets: {
      background: '#000000',
      color: '#ffffff',
      links: '#4aed05'
    }
  },
  features: {
    scrollbar: false,
    loop: false,
    live: false,
    behavior: 'all'
  }
}).render().setUser('JubatusOfficial').start();
</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="graph">
<h1>Graph<a class="headerlink" href="#graph" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>See <a class="reference external" href="https://github.com/jubatus/jubatus/blob/master/src/server/graph.idl">IDL definition</a> for detailed specification.</li>
</ul>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Configuration is given as a JSON file.
We show each filed below:</p>
<dl class="describe">
<dt>
<tt class="descname">method</tt></dt>
<dd><p>Specify algorithm for graph analysis.
You can use these algorithms.</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Method</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">&quot;graph_wo_index&quot;</span></tt></td>
<td>Use graph without index.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">parameter</tt></dt>
<dd><p>Specify parameters for the algorithm.
Its format differs for each <tt class="docutils literal"><span class="pre">method</span></tt>.</p>
<dl class="docutils">
<dt>graph_wo_index</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">damping_factor:</th><td class="field-body">Damping factor for PageRank.
It adjusts scores for nodes with differenct degrees.
The bigger it is, the more sensitive to ghraph structure PageRank score is, but the larger  biases it causes.
In the original paper, 0.85 is good.
(Float)</td>
</tr>
<tr class="field-even field"><th class="field-name">landmark_num:</th><td class="field-body">The number of landmarks for shortest path calculation.
The bigger it is, more accurate value you can get, but the more memory is required.
(Integer)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;method&quot;</span> <span class="o">:</span> <span class="s2">&quot;graph_wo_index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;parameter&quot;</span> <span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;damping_factor&quot;</span> <span class="o">:</span> <span class="mf">0.9</span><span class="p">,</span>
    <span class="s2">&quot;landmark_num&quot;</span> <span class="o">:</span> <span class="mi">5</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="data-structures">
<h2>Data Structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h2>
<dl class="describe">
<dt>
<tt class="descname">node</tt></dt>
<dd><p>Represents information for a node.
<tt class="docutils literal"><span class="pre">in_edges</span></tt> is a list of ID of incoming edges.
<tt class="docutils literal"><span class="pre">out_edges</span></tt> is a list of ID of outgoing edges.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">message</span> <span class="n">node</span> <span class="p">{</span>
  <span class="mi">0</span><span class="o">:</span> <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;</span>  <span class="n">property</span>
  <span class="mi">1</span><span class="o">:</span> <span class="n">list</span><span class="o">&lt;</span><span class="n">ulong</span><span class="o">&gt;</span>  <span class="n">in_edges</span>
  <span class="mi">2</span><span class="o">:</span> <span class="n">list</span><span class="o">&lt;</span><span class="n">ulong</span><span class="o">&gt;</span>  <span class="n">out_edges</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">preset_query</tt></dt>
<dd><p>Represents a preset query.
See the description below for details.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">message</span> <span class="n">preset_query</span> <span class="p">{</span>
  <span class="mi">0</span><span class="o">:</span> <span class="n">list</span><span class="o">&lt;</span><span class="n">tuple</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">edge_query</span>
  <span class="mi">1</span><span class="o">:</span> <span class="n">list</span><span class="o">&lt;</span><span class="n">tuple</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">node_query</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">edge</tt></dt>
<dd><p>Represents information for an edge.
<tt class="docutils literal"><span class="pre">source</span></tt> is an ID of the source node that the edge connects.
<tt class="docutils literal"><span class="pre">target</span></tt> is an ID of the target node that the edge connects.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">message</span> <span class="n">edge</span> <span class="p">{</span>
  <span class="mi">0</span><span class="o">:</span> <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;</span> <span class="n">property</span>
  <span class="mi">1</span><span class="o">:</span> <span class="n">string</span> <span class="n">source</span>
  <span class="mi">2</span><span class="o">:</span> <span class="n">string</span> <span class="n">target</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">shortest_path_query</tt></dt>
<dd><p>Represents a shortest path query information.
See the description of <tt class="docutils literal"><span class="pre">shortest_path</span></tt> method for details.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">message</span> <span class="n">shortest_path_query</span> <span class="p">{</span>
  <span class="mi">0</span><span class="o">:</span> <span class="n">string</span> <span class="n">source</span>
  <span class="mi">1</span><span class="o">:</span> <span class="n">string</span> <span class="n">target</span>
  <span class="mi">2</span><span class="o">:</span> <span class="n">uint</span> <span class="n">max_hop</span>
  <span class="mi">3</span><span class="o">:</span> <span class="n">preset_query</span> <span class="n">query</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="usage-of-properties-and-queries">
<h2>Usage of Properties and Queries<a class="headerlink" href="#usage-of-properties-and-queries" title="Permalink to this headline">¶</a></h2>
<p>Properties and Queries are both represented as key-value pair like <tt class="docutils literal"><span class="pre">{</span> <span class="pre">'key'</span> <span class="pre">:</span> <span class="pre">'value',</span> <span class="pre">'key2'</span> <span class="pre">:</span> <span class="pre">'value2',</span> <span class="pre">...</span> <span class="pre">}</span></tt>.
The condition when a query matches to a property is: all keys in a query MUST exist in a property and the corresponding value which belongs to the query and the property MUST match exactly.
The ordering of each key-value in property/query does not matter.</p>
<p>For example, this case matches:</p>
<div class="highlight-python"><pre>query:    { 'key' : 'value' }
property: { 'key' : 'value', 'foo' : 'bar' }</pre>
</div>
<p>This case does not match &#8211; same <tt class="docutils literal"><span class="pre">key</span></tt> but different value:</p>
<div class="highlight-python"><pre>query:    { 'key' : 'wrong' }
property: { 'key' : 'value', 'foo' : 'bar' }</pre>
</div>
<p>This case does not match &#8211; key <tt class="docutils literal"><span class="pre">spam</span></tt> does not exist in <tt class="docutils literal"><span class="pre">property</span></tt>:</p>
<div class="highlight-python"><pre>query:    { 'key' : 'value', 'spam': 'ham' }
property: { 'key' : 'value', 'foo' : 'bar' }</pre>
</div>
</div>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<p>For all methods, the first parameter of each method (<tt class="docutils literal"><span class="pre">name</span></tt>) is a string value to uniquely identify a task in the ZooKeeper cluster.
When using standalone mode, this must be left blank (<tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>).</p>
<dl class="describe">
<dt>
<tt class="descname">string create_node(0: string name)</tt></dt>
<dd><p>Creates a node on the graph.
Returns a node ID as string.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool remove_node(0: string name, 1: string node_id)</tt></dt>
<dd><p>Removes a node <tt class="docutils literal"><span class="pre">node_id</span></tt> from the graph.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool update_node(0: string name, 1: string node_id, 2: map&lt;string, string&gt; property)</tt></dt>
<dd><p>Updates the property of the node <tt class="docutils literal"><span class="pre">node_id</span></tt> to <tt class="docutils literal"><span class="pre">property</span></tt>.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">ulong create_edge(0: string name, 1: string node_id, 2: edge e)</tt></dt>
<dd><p>Creates a link from <tt class="docutils literal"><span class="pre">e.source</span></tt> to <tt class="docutils literal"><span class="pre">e.target</span></tt>.
Returns a edge ID as an unsigned long integer.</p>
<p>The link has a direction.
For any two nodes, multiple links with the same direction can be created.
In this case, property <tt class="docutils literal"><span class="pre">e.property</span></tt> can be associated to each link (see <tt class="docutils literal"><span class="pre">edge</span></tt>).</p>
<p><tt class="docutils literal"><span class="pre">node_id</span></tt> must be the same value as <tt class="docutils literal"><span class="pre">e.source</span></tt>.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool update_edge(0: string name, 1: string node_id, 2: ulong edge_id, 3: edge e)</tt></dt>
<dd><p>Updates an existing edge <tt class="docutils literal"><span class="pre">edge_id</span></tt> with information <tt class="docutils literal"><span class="pre">e</span></tt>.
Property will be replaced.</p>
<p><tt class="docutils literal"><span class="pre">node_id</span></tt> must be the same value as <tt class="docutils literal"><span class="pre">e.source</span></tt>.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool remove_edge(0: string name, 1: string node_id, 2: ulong edge_id)</tt></dt>
<dd><p>Removes an edge <tt class="docutils literal"><span class="pre">edge_id</span></tt>.
<tt class="docutils literal"><span class="pre">node_id</span></tt> must be an ID for the source node of the edge <tt class="docutils literal"><span class="pre">edge_id</span></tt>.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">double get_centrality(0: string name, 1: string node_id, 2: int centrality_type, 3: preset_query query)</tt></dt>
<dd><p>Calculates (gets the computed value) the centrality over the edges that match the preset query <tt class="docutils literal"><span class="pre">query</span></tt>.
The query must be registered beforehand by using <tt class="docutils literal"><span class="pre">add_centrality_query</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">centrality_type</span></tt> is a type of centrality.
Currently, only <tt class="docutils literal"><span class="pre">0</span></tt> (PageRank centrality) can be specified.</p>
<p>Centrality is computed when mix runs, thus there may be a gap between the exact value of centrality and the computed value if there&#8217;re updates not mixed.
See also the description of <tt class="docutils literal"><span class="pre">update_index</span></tt>.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool add_centrality_query(0: string name, 1: preset_query query)</tt></dt>
<dd><p>Adds a preset query <tt class="docutils literal"><span class="pre">query</span></tt> to the graph for centrality calculation.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool add_shortest_path_query(0: string name, 1: preset_query query)</tt></dt>
<dd><p>Adds a preset query <tt class="docutils literal"><span class="pre">query</span></tt> to the graph for shortest path calculation.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool remove_centrality_query(0: string name, 1: preset_query query)</tt></dt>
<dd><p>Removes a preset query <tt class="docutils literal"><span class="pre">query</span></tt> from the graph.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool remove_shortest_path_query(0: string name, 1: preset_query query)</tt></dt>
<dd><p>Removes a preset query <tt class="docutils literal"><span class="pre">query</span></tt> from the graph.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">list&lt;string&gt; get_shortest_path(0: string name, 1: shortest_path_query query)</tt></dt>
<dd><p>Calculates (from the precomputed data) a shortest path from <tt class="docutils literal"><span class="pre">query.source</span></tt> to <tt class="docutils literal"><span class="pre">query.target</span></tt> that matches the preset query.
The query must be registered beforehand by using <tt class="docutils literal"><span class="pre">add_shortest_path_query</span></tt>.
Returns a list of node IDs that represents a path from <tt class="docutils literal"><span class="pre">query.source</span></tt> to <tt class="docutils literal"><span class="pre">query.target</span></tt>.</p>
<p>If the shortest path from <tt class="docutils literal"><span class="pre">query.source</span></tt> to <tt class="docutils literal"><span class="pre">query.target</span></tt> cannot be found within <tt class="docutils literal"><span class="pre">query.max_hop</span></tt> hops, the result will be truncated.</p>
<p>Path-index tree may have a gap between the exact path and the computed path when in a distributed setup.
See also the description of <tt class="docutils literal"><span class="pre">update_index</span></tt>.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool update_index(0: string name)</tt></dt>
<dd><p>Runs mix locally. <strong>Do not use in distributed mode</strong>.</p>
<p>Some functions like <tt class="docutils literal"><span class="pre">get_centrality</span></tt> and <tt class="docutils literal"><span class="pre">get_shortest_path</span></tt> uses an index that is updated in the mix operation.
In a standalone mode, mix is not automatically called thus users must call this API by themselves.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">bool clear(0: string name)</tt></dt>
<dd><p>Clears the whole data.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">node get_node(0: string name, 1: string node_id)</tt></dt>
<dd><p>Gets the <tt class="docutils literal"><span class="pre">node</span></tt> for a node <tt class="docutils literal"><span class="pre">node_id</span></tt>.</p>
</dd></dl>

<dl class="describe">
<dt>
<tt class="descname">edge get_edge(0: string name, 1: string node_id, 2: ulong edge_id)</tt></dt>
<dd><p>Gets the <tt class="docutils literal"><span class="pre">edge</span></tt> of an edge <tt class="docutils literal"><span class="pre">edge_id</span></tt>.
<tt class="docutils literal"><span class="pre">node_id</span></tt> is an ID for the source node of the edge <tt class="docutils literal"><span class="pre">edge_id</span></tt>.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="method.html" title="Methods"
             >next</a> |</li>
        <li class="right" >
          <a href="api_stat.html" title="Stat"
             >previous</a> |</li>
        <li><a href="../index.html">Jubatus</a> &raquo;</li>
          <li><a href="references.html" >References</a> &raquo;</li>
          <li><a href="api.html" >Client API</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011,2013 PFI &amp; NTT.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>

    <!-- https://github.com/blog/273-github-ribbons -->
    <a href="http://github.com/jubatus/jubatus">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub" />
      </a>
  </body>
</html>