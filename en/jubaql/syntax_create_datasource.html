

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CREATE DATASOURCE &mdash; Jubatus</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="Jubatus" href="../index.html"/>
        <link rel="up" title="JubaQL Syntax" href="jubaql_syntax.html"/>
        <link rel="next" title="CREATE MODEL" href="syntax_create_model.html"/>
        <link rel="prev" title="JubaQL Syntax" href="jubaql_syntax.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Jubatus
          

          
            
            <img src="../_static/title.png" class="logo" />
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_distributed.html">Distributed Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fv_convert.html">Data Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../method.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Client API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tips_faqs/index.html">Tips and FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">Developer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jubakit/index.html">Jubakit</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">JubaQL</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">JubaQL Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html">JubaQL Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">JubaQL Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="jubaql_syntax.html">JubaQL Syntax</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">CREATE DATASOURCE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#explanation">Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="syntax_create_model.html">CREATE MODEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_create_stream_select.html">CREATE STREAM FROM SELECT</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_create_stream_analyze.html">CREATE STREAM FROM ANALYZE</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_create_stream_window.html">CREATE STREAM FROM SLIDING WINDOW</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_create_function.html">CREATE FUNCTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_create_trigger.html">CREATE TRIGGER</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_update_model.html">UPDATE MODEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_analyze.html">ANALYZE</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_start.html">START PROCESSING</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_stop.html">STOP PROCESSING</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_status.html">STATUS</a></li>
<li class="toctree-l3"><a class="reference internal" href="syntax_shutdown.html">SHUTDOWN</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About This Project</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Jubatus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">JubaQL</a> &raquo;</li>
      
          <li><a href="jubaql_syntax.html">JubaQL Syntax</a> &raquo;</li>
      
    <li>CREATE DATASOURCE</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="create-datasource">
<h1>CREATE DATASOURCE<a class="headerlink" href="#create-datasource" title="Permalink to this headline">¶</a></h1>
<p>Syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">DATASOURCE</span> <span class="n">source_name</span> <span class="p">[</span> <span class="p">(</span><span class="n">column_name</span> <span class="n">data_type</span> <span class="p">[,</span> <span class="o">...</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
<span class="n">FROM</span> <span class="p">(</span><span class="n">STORAGE</span><span class="p">:</span> <span class="s1">&#39;storage_location&#39;</span> <span class="p">[,</span> <span class="n">STREAM</span><span class="p">:</span> <span class="s1">&#39;storage_location&#39;</span> <span class="p">])</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">jubaql</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">DATASOURCE</span> <span class="n">nbpds</span> <span class="p">(</span><span class="n">label</span> <span class="n">string</span><span class="p">,</span> <span class="n">name</span> <span class="n">string</span><span class="p">)</span>
        <span class="n">FROM</span> <span class="p">(</span><span class="n">STORAGE</span><span class="p">:</span> <span class="s1">&#39;hdfs:///jubatus-on-yarn/sample/npb_data.json&#39;</span><span class="p">)</span>
<span class="n">CREATE</span> <span class="n">DATASOURCE</span>

<span class="n">jubaql</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">DATASOURCE</span> <span class="n">nico</span> <span class="n">FROM</span> <span class="p">(</span><span class="n">STORAGE</span><span class="p">:</span> <span class="s1">&#39;hdfs:///user/fluentd&#39;</span><span class="p">,</span>
        <span class="n">STREAM</span><span class="p">:</span> <span class="s1">&#39;kafka://hdp8:2181,hdp9:2181,hdp10:2181/fluentd/1&#39;</span><span class="p">)</span>
<span class="n">CREATE</span> <span class="n">DATASOURCE</span>
</pre></div>
</div>
<div class="section" id="explanation">
<h2>Explanation<a class="headerlink" href="#explanation" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">DATASOURCE</span></code> defines an abstract data source with a unified view of a static data set and (optionally) a data stream. Data is assumed to contain one JSON document per line.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">source_name</span></code> is a user-defined string that will identify this data source later on.</li>
<li>A schema of <code class="docutils literal"><span class="pre">column_name</span></code> and <code class="docutils literal"><span class="pre">data_type</span></code> (one of <code class="docutils literal"><span class="pre">numeric</span></code>, <code class="docutils literal"><span class="pre">string</span></code>, <code class="docutils literal"><span class="pre">boolean</span></code>) may be specified, providing a row-column shape for the JSON data.
If a schema is not given, it will be inferred from the data in each batch.</li>
<li><code class="docutils literal"><span class="pre">storage_location</span></code> is a string indicating the location of the data. Valid formats are:<ul>
<li><code class="docutils literal"><span class="pre">file://&lt;path&gt;</span></code>, <code class="docutils literal"><span class="pre">hdfs://&lt;path&gt;</span></code> and <code class="docutils literal"><span class="pre">empty</span></code> (for STORAGE)</li>
<li><code class="docutils literal"><span class="pre">kafka://&lt;zookeeper&gt;/&lt;topic&gt;/&lt;consumer-group&gt;</span></code> (for STREAM)</li>
</ul>
</li>
</ul>
<p>After a <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">DATASOURCE</span></code> statement has been processed successfully, the user can use the specified <code class="docutils literal"><span class="pre">source_name</span></code> in other statements whenever a <code class="docutils literal"><span class="pre">STREAM</span></code> is referenced. The second of the above examples is in spirit similar to PostgreSQL&#8217;s <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">VIEW</span> <span class="pre">ds</span> <span class="pre">AS</span> <span class="pre">SELECT</span> <span class="pre">json-&gt;'label'</span> <span class="pre">AS</span> <span class="pre">label,</span> <span class="pre">json-&gt;'name'</span> <span class="pre">AS</span> <span class="pre">name</span> <span class="pre">FROM</span> <span class="pre">hdfs_table</span></code>.</p>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>To retrieve data from fluentd, fluentd must be configured to push its data to Kafka using <a class="reference external" href="https://github.com/htgc/fluent-plugin-kafka/">fluent-plugin-kafka</a>. This is required because fluentd expects to <em>push</em> data somewhere while Spark expects to <em>pull</em> data from somewhere, so there is a message queue needed in between. Kafka seems to fulfill this requirement quite well.</li>
<li>When seamless switching from static to stream processing is desired, there must be a field with the key <code class="docutils literal"><span class="pre">&quot;jubaql_timestamp&quot;</span></code> in every data item with strictly increasing (as per string ordering) string values.
Otherwise items in the Kafka queue that are also in the previously processed static data set will be processed again.</li>
<li>Schema inference increases processing time and carries the risk of a wrongly inferred data type (since only a sampled subset is considered for inference), leading to type cast errors at runtime.
Also, an empty schema will be inferred for empty batches, leading to problems with many other statements.
Unless data is directly fed from a data source to a a model update process, schema inference should therefore be avoided at the moment.</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="syntax_create_model.html" class="btn btn-neutral float-right" title="CREATE MODEL" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="jubaql_syntax.html" class="btn btn-neutral" title="JubaQL Syntax" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2017 PFN &amp; NTT.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>